<!DOCTYPE html>
<html>
<head>
  <title>Gist Viewer</title>
  <style>
    #texto {
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
  </style>
</head>
<body>
  <h1>Gist Viewer</h1>
  <textarea id="texto"></textarea>
  <button id="salvar">Salvar</button>
  <div id="mensagem"></div>

  <script>
    const gistId = 'b996dc535ebcc23c8b45f8979b4d86e0';
    const filename = 'meses_escala.json';
    const token = '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'; 

    // Função para carregar o Gist
    function carregarGist() {
      fetch(`https://api.github.com/gists/${gistId}`)
        .then(response => response.json())
        .then(gist => {
          const file = gist.files[filename];
          if (file) {
            const texto = file.content;
            document.getElementById('texto').value = texto;
          } else {
            document.getElementById('texto').value = `Arquivo ${filename} não encontrado`;
          }
        })
        .catch(error => console.error(error));
    }

    // Carregar o Gist inicialmente
    carregarGist();

    // Salvar alterações
    document.getElementById('salvar').addEventListener('click', () => {
      const novoTexto = document.getElementById('texto').value;
      const dados = {
        "files": {
          [filename]: {
            "content": novoTexto
          }
        }
      };

      fetch(`https://api.github.com/gists/${gistId}`, {
        method: 'PATCH',
        headers: {
          'Authorization': `Bearer ${token}`,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(dados)
      })
      .then(response => response.json())
      .then(data => {
        document.getElementById('mensagem').innerText = 'Alterações salvas com sucesso!';
        // Recarregar o Gist após salvar as alterações
        carregarGist();
        setTimeout(() => {
          document.getElementById('mensagem').innerText = '';
        }, 2000);
      })
      .catch(error => console.error(error));
    });
  </script>
</body>
</html>
